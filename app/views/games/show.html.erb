<% @game = Game.find(session[:game_id]) %>
<div class="container">
  <h3 class="center-align">Unscramble the fortune to get the cookie!</h3>
  <% if session[:bear] %>
  <div class="card-panel red darken-1">
    <span class="black-text ">
      <div class="left valign-wrapper">
        <%= image_tag("bear_icon.png", :alt => "bear", style:"width:50px;height:50px;") %>  COOKIE BEAR GOT UR COOKIE
      </div>
      <div class="right valign-wrapper">
        Game Score: <%= @game.score %>
      </div>
      <br>
    </span>
  </div>
  <% else %>
  <div class="card-panel yellow lighten-4">
    <span class="black-text ">
      <div class="left valign-wrapper">
        <%= image_tag("fortune_icon.png", :alt => "fortune", style:"width:50px;height:50px;") %>  U WON A COOKIE
      </div>
      <div class="right valign-wrapper">
        Game Score: <%= @game.score %>
      </div>
      <br>
    </span>
  </div>
  <% end %>


  <div class="card horizontal medium">
    <div class="card-image">
      <%= image_tag("doom.png", :alt => "doom") %>
    </div>
    <div class="card-stacked">
      <div class="card-content">
        <h4>
          <div id="text">
            <%= @game.fortune_scrambler %>
          </div>
          <br>
          <button id="shuffle" type="button" class="btn">Shuffle Words</button>
        </h4>
      </div>
      <div class="card-action">
        <%= form_tag game_update_path, method: "patch" do %>
        <%= text_field_tag :user_answer %>
        <%= hidden_field_tag 'game', @game %>
        <%= submit_tag "Submit Answer", class:"btn" %>
        <% end %>
      </div>
    </div>
  </div>








</div>
<script>

document.addEventListener('DOMContentLoaded', function(){

    var textDiv = document.getElementById('text');
    document.getElementById('shuffle').addEventListener('click',function(){
        var words = textDiv.innerText.split(' ');
        var len = words.length;
        var result = '';
        textDiv.innerText = '';
        for(var i = 0; i < len; ++i){
            var randIndex = Math.floor((Math.random() * (words.length)));
            result += words[randIndex] + ' ';
            words.splice(randIndex, 1);
        }
        textDiv.innerText = result;
    }, false);
}, false)

</script>
